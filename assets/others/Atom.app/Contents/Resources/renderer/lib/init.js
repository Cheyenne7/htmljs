// Generated by CoffeeScript 1.6.3
(function() {
  var Module, globalPaths, path, pathname;

  path = require('path');

  Module = require('module');

  process.__atom_type = 'renderer';

  process.resourcesPath = path.resolve(process.argv[1], '..', '..', '..');

  process.argv.splice(1, 1);

  globalPaths = Module.globalPaths;

  globalPaths.push(path.join(process.resourcesPath, 'renderer', 'api', 'lib'));

  globalPaths.push(path.join(process.resourcesPath, 'app'));

  require(path.resolve(__dirname, '..', '..', 'common', 'lib', 'init.js'));

  global.require = require;

  global.module = module;

  if (window.location.protocol === 'file:') {
    pathname = process.platform === 'win32' ? window.location.pathname.substr(1) : window.location.pathname;
    global.__filename = decodeURIComponent(pathname);
    global.__dirname = path.dirname(global.__filename);
    module.filename = global.__filename;
    module.paths = module.paths.concat(Module._nodeModulePaths(global.__dirname));
  } else {
    global.__filename = __filename;
    global.__dirname = __dirname;
  }

  window.onerror = function(error) {
    if (global.process.listeners('uncaughtException').length > 0) {
      global.process.emit('uncaughtException', error);
      return true;
    } else {
      return false;
    }
  };

  window.close = function() {
    return require('remote').getCurrentWindow().close();
  };

  window.open = function(url, name, features) {
    var BrowserWindow, browser, feature, options, value, _i, _len, _ref, _ref1;
    options = {};
    _ref = features.split(',');
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      feature = _ref[_i];
      _ref1 = feature.split('='), name = _ref1[0], value = _ref1[1];
      options[name] = value === 'yes' ? true : value === 'no' ? false : value;
    }
    if (options.x == null) {
      options.x = options.left;
    }
    if (options.y == null) {
      options.y = options.top;
    }
    if (options.title == null) {
      options.title = name;
    }
    if (options.width == null) {
      options.width = 800;
    }
    if (options.height == null) {
      options.height = 600;
    }
    BrowserWindow = require('remote').require('browser-window');
    browser = new BrowserWindow(options);
    browser.loadUrl(url);
    return browser;
  };

}).call(this);
